# ШАД Бот - Telegram Bot для задач магистерской олимпиады ШАД

Telegram-бот для ежедневной отправки случайных задач из магистерской олимпиады ШАД (Школа Анализа Данных Яндекса). Бот автоматически выбирает задачи, отслеживает историю отправок и работает в московском часовом поясе.

## Функционал

- Ежедневная автоматическая рассылка в 10:00 по московскому времени
- Случайный выбор задач без повторений для каждого чата
- Структурированная база задач по годам и вариантам
- Автоматическое прикрепление решений из solver.txt
- Административные команды для управления задачами
- Локальное хранение изображений условий задач

## Структура проекта
shad_bot/
├── data/
│ └── 2021/
│ ├── var_1/
│ │ ├── 21_1_1.jpg
│ │ ├── 21_1_2.jpg
│ │ └── solver.txt
│ └── var_2/
├── pycache/
├── .env
├── .gitignore
├── bot.py
├── config.py
├── database.py
├── readme.md
├── requirements.txt
├── shad_bot.db
└── task_scanner.py

## Установка и настройка

### 1. Клонирование репозитория
```bash
git clone <ваш-репозиторий>
cd shad_bot
```
### 2. Установка зависимостей
```bash
pip install -r requirements.txt
```

### 3. Настройка конфигурации
Создайте файл `.env` в корне проекта:
```env
BOT_TOKEN=ваш_telegram_bot_token_от_BotFather
ADMIN_IDS=ваш_telegram_id_через_запятую
# DEFAULT_CHAT_ID=-1001234567890  # Опционально: ID чата для автоматической отправки
```
## Использование

## Команды бота

Для всех пользователей:

- `/start` — Активировать бота в чате, начать ежедневную рассылку  
- `/task` — Получить случайную задачу немедленно  

Для администраторов (ID из ADMIN_IDS):

- `/scan_tasks` — Пересканировать папку data и обновить БД  

---

## Технические детали

### Стек технологий

- Python 3.8+ — основной язык  
- aiogram 3.x — асинхронная библиотека для Telegram Bot API  
- SQLite 3 — база данных  
- APScheduler — планировщик задач  
- pytz — работа с часовыми поясами  

---

### База данных (SQLite)

Бот использует 4 таблицы:

1. `tasks` — хранит информацию о задачах  
2. `chats` — зарегистрированные чаты для рассылки  
3. `sent_tasks` — история отправленных задач  
4. `schedules` — расписание отправки для каждого чата  

---

### Особенности

- Работа в московском часовом поясе даже при запуске на сервере в другом регионе  
- Инкрементальное сканирование — добавление только новых задач  
- Устойчивость к ошибкам — продолжает работу при проблемах с отдельными задачами  